{% extends "base.html" %}

{% block title %}Getting Started | NSF NCAR CIRRUS{% endblock %}
{% block og_title %}Getting Started | NSF NCAR CIRRUS{% endblock %}

{% block content %}
<div class="page-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-10 mx-auto text-center">
                <h1 class="page-title">CIRRUS Architecture</h1>
                <p class="page-description">
                    A look at the different components used to build CIRRUS and how they can be used to grow the reach of your science.
                </p>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="content-wrapper">
        <section class="mb-5 architecture">
            <h2 class="section-heading">Basic CIRRUS Architecture</h2>
            <img src="{{ url_for('static', filename='images/CIRRUS-basic-arch.png') }}" 
                                 alt="CIRRUS Basic Architecture"
                                 class="">
            <hr>
            <h2>Understanding the CIRRUS Platform</h2>
            <br>
            <p>CIRRUS is a cloud-native Kubernetes platform. This means applications designed to run on CIRRUS can run on any Kubernetes cluster—whether on-premises, in the cloud (AWS, GCP, Azure), or on other infrastructure. The platform uses industry-standard tools and practices, ensuring your work is portable and not locked into a specific environment.</p>

            <h3>What is a Container?</h3>

            <p>A container is a way to package your application with all the dependencies it needs to run, without including anything extra. It provides only what you need and makes reproducibility easy—your application runs the same way everywhere, whether on your laptop, a colleague's machine, or in production.</p>

            <h3>Starting with the Basics: Containers and Kubernetes</h3>

            <p>Kubernetes is a container orchestration platform that manages containerized applications at scale. Once you have a working container image, you store it in a container registry. CIRRUS provides Harbor as a private registry, and you can also use public registries like GHCR (GitHub Container Registry) or Docker Hub.</p>

            <h3>Defining Your Application: Helm Charts</h3>

            <p>Once your image is in a registry, it can be referenced in a Helm chart—a package that defines how your application deploys on Kubernetes, including configuration, resources, and dependencies.</p>

            <h3>Automation: CI/CD with GitHub Actions</h3>

            <p>GitHub Actions workflows automate your deployment pipeline. When you push code changes, workflows automatically build a new container image, push it to your container registry, update your Helm chart values to reference the new image, and trigger Argo CD to deploy the updated application.</p>

            <p>With CIRRUS, you can connect a GitHub Actions Runner Scale Set to your repository. This provides access to more computational resources including GPUs, allowing your CI/CD workflows to run directly on the Kubernetes cluster with the hardware your builds and tests require.</p>

            <h3>Continuous Deployment: Argo CD</h3>

            <p>Argo CD continuously monitors your Helm charts in Git repositories. When changes are detected, it automatically syncs and deploys your application to the Kubernetes cluster, implementing true GitOps practices.</p>

            <h3>Accessing Your Application: Ingress and TLS</h3>

            <p>CIRRUS provides two ingress paths: LoxiLB for external traffic using BGP peering to provide publicly accessible endpoints, and NGINX Ingress for internal traffic within the UCAR network.</p>

            <p>ExternalDNS automatically creates DNS records in the *.k8s.ucar.edu domain for your services, while cert-manager issues and manages TLS certificates from Let's Encrypt to provide HTTPS endpoints for your web applications.</p>

            <h3>Security: Secrets Management</h3>

            <p>OpenBao works with the External Secrets Operator to securely store sensitive data like API keys, passwords, and credentials. Secrets are encrypted at rest in OpenBao and securely injected into your containers with encryption in transit, ensuring sensitive information never lives in your Git repository or Helm charts.</p>

            <h3>Databases: CloudNativePG</h3>

            <p>If your application needs a database, CIRRUS offers CloudNativePG—a Kubernetes operator that deploys and manages highly available PostgreSQL clusters with automated backups, failover, and scaling.</p>

            <h3>Observability: Monitoring and Logging</h3>

            <p>CIRRUS provides access to Grafana, which integrates with Prometheus (for metrics) and Loki (for logs) to gather telemetry from your applications. You can create custom dashboards to analyze and monitor application performance, set up alerts, and troubleshoot issues.</p>
    </div>
</div>
{% endblock %}
